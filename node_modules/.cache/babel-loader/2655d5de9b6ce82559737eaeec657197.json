{"ast":null,"code":"import _toConsumableArray from\"/home/revpro/Desktop/new/ToDoApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/revpro/Desktop/new/ToDoApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import netCalls from'../netCallsShare';import SearchBar from'./SearchBar';import TodoList from'./TodoListShare';import InputTodo from'./InputTodoShare';import'./TodoApp.css';var PORT=8000;var getURL=\"http://localhost:\".concat(PORT,\"/getdata\");var shareSocketURL=\"ws://localhost:\".concat(PORT,\"/shareSocket\");function SharedTodo(props){var url=new URL(document.URL);var search_params=url.searchParams;var hash_val=search_params.get('hash');var _useState=useState([]),_useState2=_slicedToArray(_useState,2),todos=_useState2[0],setTodos=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),searchQuery=_useState4[0],setSearchQuery=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),filteredTodos=_useState6[0],setFilteredTodos=_useState6[1];var _useState7=useState(new Date().toLocaleDateString(\"en-IN\",{day:\"numeric\",month:\"short\",weekday:\"short\"})),_useState8=_slicedToArray(_useState7,1),date=_useState8[0];var _useState9=useState(hash_val),_useState10=_slicedToArray(_useState9,1),hash=_useState10[0];var _useState11=useState(new WebSocket(shareSocketURL)),_useState12=_slicedToArray(_useState11,2),setSocket=_useState12[1];var state={todos:todos,searchQuery:searchQuery,filteredTodos:filteredTodos,date:date,hash:hash,listNum:1,totalLists:1,id_token:null,sharing:\"off\"};// let updateState = (stateData:State) => {\n//     if(stateData.todos) setTodos([...stateData.todos]);\n//     if(stateData.searchQuery) setSearchQuery(stateData.searchQuery);\n//     if(stateData.filteredTodos !== undefined){\n//         if(stateData.filteredTodos === null) setFilteredTodos(null);\n//         else setFilteredTodos([...stateData.filteredTodos]);\n//     } \n//     if(stateData.date) setDate(stateData.date);\n//     if(stateData.hash) setHash(stateData.hash);\n// }\nuseEffect(function(){console.log(\"here Mount\");// this.onLoad();\nvar startSocket=new WebSocket(shareSocketURL);setSocket(startSocket);console.log(\"initial load\");var todos=[];netCalls.getJSON(getURL,function(err,data){if(err!==null){console.log(\"Empty\");setTodos([].concat(todos));}else{console.log(\"Loaded\");console.log(data);var dataWithKey=data;if(dataWithKey[\"json\"]!==undefined)setTodos(JSON.parse(dataWithKey[\"json\"]));}},hash,startSocket);startSocket.onmessage=function(event){console.log(event.data);var data=JSON.parse(event.data);setTodos(_toConsumableArray(data));};},[hash]);return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"date\"},date),/*#__PURE__*/React.createElement(SearchBar,{state:state,setFilteredTodos:setFilteredTodos,setSearchQuery:setSearchQuery})),/*#__PURE__*/React.createElement(TodoList,{state:state,setTodos:setTodos}),/*#__PURE__*/React.createElement(InputTodo,{state:state,setTodos:setTodos}));}export default SharedTodo;","map":{"version":3,"sources":["/home/revpro/Desktop/new/ToDoApp/src/components/SharedTodo.tsx"],"names":["React","useState","useEffect","netCalls","SearchBar","TodoList","InputTodo","PORT","getURL","shareSocketURL","SharedTodo","props","url","URL","document","search_params","searchParams","hash_val","get","todos","setTodos","searchQuery","setSearchQuery","filteredTodos","setFilteredTodos","Date","toLocaleDateString","day","month","weekday","date","hash","WebSocket","setSocket","state","listNum","totalLists","id_token","sharing","console","log","startSocket","getJSON","err","data","dataWithKey","undefined","JSON","parse","onmessage","event"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport netCalls from '../netCallsShare';\nimport SearchBar from './SearchBar';\nimport TodoList from './TodoListShare';\nimport InputTodo from './InputTodoShare';\nimport './TodoApp.css';\nimport {State,TodoItem} from './interfaces';\nconst PORT = 8000;\nconst getURL = `http://localhost:${PORT}/getdata`;\nconst shareSocketURL = `ws://localhost:${PORT}/shareSocket`;\n\ninterface Data{\n  [Key:string]:string|undefined;\n}\n\nfunction SharedTodo(props:{state:{\n  id_token:string;\n}}) {\n    const url = new URL(document.URL);\n    const search_params = url.searchParams;\n    const hash_val = search_params.get('hash');\n    const [todos, setTodos] = useState<TodoItem[]>([]);\n    const [searchQuery, setSearchQuery] = useState(\"\");\n    let [filteredTodos, setFilteredTodos] = useState<TodoItem[]|null>(null);\n    const [date, ] = useState((new Date()).toLocaleDateString(\"en-IN\", {day: \"numeric\", month: \"short\", weekday: \"short\"}));\n    const [hash, ] = useState(hash_val);\n    const [, setSocket] = useState<WebSocket>(new WebSocket(shareSocketURL));\n    const state:State = {\n        todos: todos,\n        searchQuery: searchQuery,\n        filteredTodos: filteredTodos,\n        date: date,\n        hash: hash,\n        listNum:1,\n        totalLists:1,\n        id_token:null,\n        sharing:\"off\",\n    };\n\n    // let updateState = (stateData:State) => {\n    //     if(stateData.todos) setTodos([...stateData.todos]);\n    //     if(stateData.searchQuery) setSearchQuery(stateData.searchQuery);\n    //     if(stateData.filteredTodos !== undefined){\n    //         if(stateData.filteredTodos === null) setFilteredTodos(null);\n    //         else setFilteredTodos([...stateData.filteredTodos]);\n    //     } \n    //     if(stateData.date) setDate(stateData.date);\n    //     if(stateData.hash) setHash(stateData.hash);\n    // }\n\n    useEffect(() => {\n        console.log(\"here Mount\");\n        // this.onLoad();\n        let startSocket = new WebSocket(shareSocketURL);\n        setSocket(startSocket);\n\n        console.log(\"initial load\");\n        let todos :TodoItem[]= [];\n        netCalls.getJSON(getURL, (err:number|null, data:object) => {\n            if(err !== null){\n                console.log(\"Empty\");\n                setTodos([...todos]);\n            }\n            else{\n                console.log(\"Loaded\");\n                console.log(data);\n                let dataWithKey=data as Data;\n                if(dataWithKey[\"json\"]!==undefined)\n                  setTodos(JSON.parse(dataWithKey[\"json\"]));\n            }\n        }, hash, startSocket);\n\n        startSocket.onmessage = (event) => {\n            console.log(event.data);\n            let data = JSON.parse(event.data);\n            setTodos([...data]);\n        }\n    }, [hash])\n\n    return (\n        <div className=\"container\">\n            <div className=\"header\">\n                <div className=\"date\">{date}</div>\n                <SearchBar state={state} setFilteredTodos={setFilteredTodos} setSearchQuery={setSearchQuery}/>\n            </div>\n            <TodoList state={state} setTodos={setTodos}/>\n            <InputTodo state={state} setTodos={setTodos}/>\n        </div>\n    );\n\n}\n\nexport default SharedTodo;"]},"metadata":{},"sourceType":"module"}